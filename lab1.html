

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>REPTAR Introduction &mdash; SEEE 0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="SEEE 0.0 documentation" href="index.html"/>
        <link rel="next" title="Periferal Emulations" href="lab2.html"/>
        <link rel="prev" title="Welcome to SEEE’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SEEE
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">REPTAR Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#environment-setup">1) Environment setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#qemu-startup">2) QEMU startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#u-boot-test">3) U-Boot test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linux-test">4) Linux test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-on-real-platform">5) Test on real platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reptar-periferal-access">6) REPTAR periferal access</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">Periferal Emulations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SEEE</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>REPTAR Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/lab1.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reptar-introduction">
<h1>REPTAR Introduction<a class="headerlink" href="#reptar-introduction" title="Permalink to this headline">¶</a></h1>
<p>This part has the goal to setup and to make a first contact with the environment used for the SEEE hand-on work (laboratory).</p>
<div class="section" id="environment-setup">
<h2>1) Environment setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h2>
<p>The project files are provided as a tarball. The tarball was downloaded in the <cite>~/Downloads</cite> directory. We can exctract the repository with the following commands:</p>
<blockquote>
<div><a class="reference external" href="mailto:redsuser&#37;&#52;&#48;vm-reds-2015s2">redsuser<span>&#64;</span>vm-reds-2015s2</a>:~$ tar xf Downloads/seee_student.tar.gz
<a class="reference external" href="mailto:redsuser&#37;&#52;&#48;vm-reds-2015s2">redsuser<span>&#64;</span>vm-reds-2015s2</a>:~$ cd seee_student/</div></blockquote>
<p>We can now open Ecplise and select <cite>/home/redsuser/seee_student</cite> as workspace.</p>
<p>Next step is to build the QEMU emulator. The project downloaded is not clean, so we need to clean it first. Then we can build the emulator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ cd qemu-reds
redsuser@vm-reds-2015s2:~/seee_student/qemu-red$ make distclean
redsuser@vm-reds-2015s2:~/seee_student/qemu-red$ cd..
redsuser@vm-reds-2015s2:~/seee_student$ make qemu
</pre></div>
</div>
</div>
<div class="section" id="qemu-startup">
<h2>2) QEMU startup<a class="headerlink" href="#qemu-startup" title="Permalink to this headline">¶</a></h2>
<p>We can then run the Emulator direcly from Eclipse. For that select <em>Run -&gt; Debug Configuration</em>. Then select the <em>gemu-reds Debug</em> configuration and click <em>Debug</em>. A black Windows apears, this is the emulator windows.</p>
<p>We can pause the Emulator exectution:</p>
<blockquote>
<div><img alt="_images/qemu_debugger.png" src="_images/qemu_debugger.png" />
</div></blockquote>
<p>We can see that the emulator is stopped int the __GI_pppoll() function. We can then stop the execution.</p>
<p>From the command line we can start the QEMU as well at we arrive in the U-Boot environment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ ../stf
bash: ../stf: No such file or directory
redsuser@vm-reds-2015s2:~/seee_student$ ./stf
WARNING: Image format was not specified for &#39;filesystem/flash&#39; and probing guessed raw.
         Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.
         Specify the &#39;raw&#39; format explicitly to remove the restrictions.
WARNING: Image format was not specified for &#39;filesystem/sd-card.img&#39; and probing guessed raw.
         Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.
         Specify the &#39;raw&#39; format explicitly to remove the restrictions.
reptar-sp6-emul: sp6_emul_init
sp6_emul_init: failed to connect to SP6 server
sp6_emul_init: terminate thread


U-Boot 2011.09-00000-g9af6a15 (Feb 10 2015 - 16:10:59)

U-Boot code: 80008000 -&gt; 80065570  BSS: -&gt; 800F7C68
OMAP35XX-GP ES3.1, CPU-OPP2, L3-165MHz, Max CPU Clock 600 mHz
REPTAR Board + LPDDR/NAND
I2C:   ready
monitor len: 000EFC68
ramsize: 10000000
TLB table at: 8fff0000
Top of RAM usable for U-Boot at: 8fff0000
Reserving 959k for U-Boot at: 8ff00000
Reserving 136k for malloc() at: 8fede000
Reserving 32 Bytes for Board Info at: 8feddfe0
Reserving 128 Bytes for Global Data at: 8feddf60
New Stack Pointer is: 8feddf50
RAM Configuration:
Bank #0: 80000000 256 MiB
Bank #1: 90000000 0 Bytes
relocation Offset is: 0fef8000
WARNING: Caches not enabled
monitor flash len: 00066970
Now running in RAM - U-Boot at: 8ff00000
Flash: 16 KiB
Flash pflash NOR detected.
MMC:   OMAP SD/MMC: 0
In:    serial
Out:   serial
Err:   serial
fpga_init: CONFIG_FPGA = 0x1
Net:   smc911x-0
Warning: smc911x-0 MAC addresses don&#39;t match:
Address in SROM is         52:54:00:12:34:56
Address in environment is  e4:af:a1:40:01:fe

Reptar #
</pre></div>
</div>
</div>
<div class="section" id="u-boot-test">
<h2>3) U-Boot test<a class="headerlink" href="#u-boot-test" title="Permalink to this headline">¶</a></h2>
<p>For the U-Boot command prompt we can enter command like printing the environment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Reptar # printenv
baudrate=115200
boot_linux=mmc rescan; fatload mmc 0 ${loadaddr} uImage; setenv bootargs console=ttyO2,115200n8 noinitrd rw consoleblank=0 root=/dev/mmcblk0p2 rootwait ethaddr=${ethaddr} ip=${ipaddr}:${serverip}:${gatewayip}:${netmask}:::off; bootm ${loadaddr}
bootargs=console=ttyO2,115200n8 noinitrd rw consoleblank=0 root=/dev/mmcblk0p2 rootwait bootm 0x81600000
bootcmd=mmc rescan; fatload mmc 0 0x81600000 uImage; setenv bootargs console=ttyO2,115200n8 noinitrd rw consoleblank=0 root=/dev/mmcblk0p2 rootwait; bootm 0x81600000
bootdelay=-1
ethact=smc911x-0
ethaddr=E4:AF:A1:40:01:FE
fileaddr=81600000
filesize=4AC808
goapp=go 0x81600000
ipaddr=10.0.2.10
loadaddr=0x81600000
netmask=255.255.255.0
serverip=10.0.2.2
stderr=serial
stdin=serial
stdout=serial
test=test string
tftp1=tftp helloworld_u-boot/helloworld.bin
tftp2=tftp gpio_u-boot/gpio_u-boot.bin
tftp3=tftp sp6_buttons_u-boot/sp6_buttons.bin

Environment size: 949/4092 bytes
</pre></div>
</div>
<p>We can then buid the U-Boot demo executable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ cd helloworld_u-boot/
redsuser@vm-reds-2015s2:~/seee_student/helloworld_u-boot$ make
arm-linux-gnueabihf-gcc -g  -O0  -fno-common -ffixed-r8 -msoft-float  -D__KERNEL__ -Iinclude -fno-builtin -ffreestanding -nostdinc -isystem /opt/linaro-arm-linux-gnueabihf/bin/../lib/gcc/arm-linux-gnueabihf/4.7.3/include -pipe  -DCONFIG_ARM -D__ARM__ -marm  -mabi=aapcs-linux -mno-thumb-interwork  -Wall -Wstrict-prototypes -c -o stubs.o stubs.c
arm-linux-gnueabihf-ar crv libstubs.a stubs.o
a - stubs.o
arm-linux-gnueabihf-gcc -g  -O0  -fno-common -ffixed-r8 -msoft-float  -D__KERNEL__ -Iinclude -fno-builtin -ffreestanding -nostdinc -isystem /opt/linaro-arm-linux-gnueabihf/bin/../lib/gcc/arm-linux-gnueabihf/4.7.3/include -pipe  -DCONFIG_ARM -D__ARM__ -marm  -mabi=aapcs-linux -mno-thumb-interwork  -Wall -Wstrict-prototypes -c -o helloworld.o helloworld.c
arm-linux-gnueabihf-gcc  -D__ASSEMBLY__ -g  -O0  -fno-common -ffixed-r8 -msoft-float  -D__KERNEL__ -Iinclude -fno-builtin -ffreestanding -nostdinc -isystem /opt/linaro-arm-linux-gnueabihf/bin/../lib/gcc/arm-linux-gnueabihf/4.7.3/include -pipe  -c -o crt0.o crt0.S
arm-linux-gnueabihf-ld -g  -Ttext 0x81600000 \
                        -o helloworld crt0.o helloworld.o stubs.o \
                        -L/opt/linaro-arm-linux-gnueabihf/bin/../lib/gcc/arm-linux-
</pre></div>
</div>
<p>We can run this executable frome U-Boot. First we need to make the binary image availbe on the TFTP server. For this we copy it to the tftpboot foldeer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ cp helloworld_u-boot/helloworld.bin ../tftpboot/helloworld_u-boot
redsuser@vm-reds-2015s2:~/seee_student$
</pre></div>
</div>
<p>Then in U-Boot wen can load this image using TFTP and the predefined variables:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Reptar</span> <span class="c1"># run tftp1</span>
<span class="n">smc911x</span><span class="p">:</span> <span class="n">detected</span> <span class="n">LAN9118</span> <span class="n">controller</span>
<span class="n">smc911x</span><span class="p">:</span> <span class="n">phy</span> <span class="n">initialized</span>
<span class="n">smc911x</span><span class="p">:</span> <span class="n">MAC</span> <span class="n">e4</span><span class="p">:</span><span class="n">af</span><span class="p">:</span><span class="n">a1</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="n">fe</span>
<span class="n">Using</span> <span class="n">smc911x</span><span class="o">-</span><span class="mi">0</span> <span class="n">device</span>
<span class="n">TFTP</span> <span class="kn">from</span> <span class="nn">server</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">2.2</span><span class="p">;</span> <span class="n">our</span> <span class="n">IP</span> <span class="n">address</span> <span class="ow">is</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">2.10</span>
<span class="n">Filename</span> <span class="s1">&#39;helloworld_u-boot/helloworld.bin&#39;</span><span class="o">.</span>
<span class="n">Load</span> <span class="n">address</span><span class="p">:</span> <span class="mh">0x81600000</span>
<span class="n">Loading</span><span class="p">:</span> <span class="c1">#</span>
<span class="n">done</span>
<span class="n">Bytes</span> <span class="n">transferred</span> <span class="o">=</span> <span class="mi">776</span> <span class="p">(</span><span class="mi">308</span> <span class="nb">hex</span><span class="p">)</span>
<span class="n">Reptar</span> <span class="c1"># go</span>
</pre></div>
</div>
<p>And Then we can start the loaded image as we know the loading address of the image for the output of the TFTP command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Reptar</span> <span class="c1"># go 0x81600000</span>
<span class="c1">## Starting application at 0x81600000 ...</span>
<span class="n">Example</span> <span class="n">expects</span> <span class="n">ABI</span> <span class="n">version</span> <span class="mi">6</span>
<span class="n">Actual</span> <span class="n">U</span><span class="o">-</span><span class="n">Boot</span> <span class="n">ABI</span> <span class="n">version</span> <span class="mi">6</span>
<span class="n">Hello</span> <span class="n">World</span>
<span class="n">argc</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0x81600000&quot;</span>
<span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&lt;NULL&gt;&quot;</span>
<span class="n">Hit</span> <span class="nb">any</span> <span class="n">key</span> <span class="n">to</span> <span class="n">exit</span> <span class="o">...</span>

<span class="c1">## Application terminated, rc = 0x0</span>
<span class="n">Reptar</span> <span class="c1">#</span>
</pre></div>
</div>
<p>We can then debug this application. For this, First start the emulator with the <cite>./stf</cite> script. Then in Ecplipse we select the <strong>helloworld_u-boot Debug</strong> debug confiuration. The debuger start but noting appends. We need to load manualy the image in U-Boot as described above. We have have then the debugger ready in elcpise:</p>
<blockquote>
<div><img alt="_images/uboot_helloworld_debug.png" src="_images/uboot_helloworld_debug.png" />
</div></blockquote>
</div>
<div class="section" id="linux-test">
<h2>4) Linux test<a class="headerlink" href="#linux-test" title="Permalink to this headline">¶</a></h2>
<p>We can deploy the Linux kernel on the virtual SD card of the emulator. For this we have script ready:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ ./deploy
Deploying into reptar rootfs ...
Mounting filesystem/sd-card.img...
[sudo] password for redsuser:
SD card partitions mounted in &#39;boot_tmp&#39; and &#39;filesystem_tmp&#39; directories
cp: cannot stat &#39;drivers/sp6.ko&#39;: No such file or directory
cp: cannot stat &#39;drivers/usertest&#39;: No such file or directory
cp: cannot stat &#39;drivers/buttons_test&#39;: No such file or directory
Unmounting SD card image...
  Synchronizing .img file
  Unmounting &#39;boot_tmp&#39; and &#39;filesystem_tmp&#39;...
Done !
</pre></div>
</div>
<p>We can then compile the test appication provided:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ cd helloworld_linux/
redsuser@vm-reds-2015s2:~/seee_student/helloworld_linux$ ll
total 32
drwxrwxr-x  2 redsuser redsuser  4096 Feb 21 11:14 ./
drwxrwxr-x 15 redsuser redsuser  4096 Mar  1 18:26 ../
-rw-rw-r--  1 redsuser redsuser 11388 Feb 21 11:14 .cproject
-rw-rw-r--  1 redsuser redsuser   378 Feb 21 11:14 helloworld.c
-rw-rw-r--  1 redsuser redsuser   634 Feb 21 11:14 Makefile
-rw-rw-r--  1 redsuser redsuser  2446 Feb 21 11:14 .project
redsuser@vm-reds-2015s2:~/seee_student/helloworld_linux$ make
arm-linux-gnueabihf-gcc -marm -g -c helloworld.c
arm-linux-gnueabihf-gcc -o helloworld helloworld.o
</pre></div>
</div>
<p>And we copy it to the rootfs of the linux image:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ ./mount-sd.sh
Mounting filesystem/sd-card.img...
SD card partitions mounted in &#39;boot_tmp&#39; and &#39;filesystem_tmp&#39; directories
redsuser@vm-reds-2015s2:~/seee_student$ sudo cp helloworld_linux/helloworld filesystem_tmp/root/
redsuser@vm-reds-2015s2:~/seee_student$ ./umount-sd.sh
Unmounting SD card image...
  Synchronizing .img file
  Unmounting &#39;boot_tmp&#39; and &#39;filesystem_tmp&#39;...
Done !
</pre></div>
</div>
<p>We can start the QEMU emulator with the virtual SD-CARD using the <cite>./stq</cite> script:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>redsuser@vm-reds-2015s2:~/seee_student$ ./stq
libGL error: failed to authenticate magic 3
libGL error: failed to load driver: vboxvideo
Running QEMU
WARNING: Image format was not specified for &#39;filesystem/flash&#39; and probing guessed raw.
         Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.
         Specify the &#39;raw&#39; format explicitly to remove the restrictions.
WARNING: Image format was not specified for &#39;filesystem/sd-card.img&#39; and probing guessed raw.
         Automatically detecting the format is dangerous for raw images, write operations on block 0 will be restricted.
         Specify the &#39;raw&#39; format explicitly to remove the restrictions.
reptar-sp6-emul: sp6_emul_init


U-Boot 2011.09-00000-g9af6a15 (Feb 10 2015 - 16:10:59)

U-Boot code: 80008000 -&gt; 80065570  BSS: -&gt; 800F7C68
OMAP35XX-GP ES3.1, CPU-OPP2, L3-165MHz, Max CPU Clock 600 mHz
REPTAR Board + LPDDR/NAND
I2C:   ready
monitor len: 000EFC68
ramsize: 10000000
TLB table at: 8fff0000
Top of RAM usable for U-Boot at: 8fff0000
Reserving 959k for U-Boot at: 8ff00000
Reserving 136k for malloc() at: 8fede000
Reserving 32 Bytes for Board Info at: 8feddfe0
Reserving 128 Bytes for Global Data at: 8feddf60
New Stack Pointer is: 8feddf50
RAM Configuration:
Bank #0: 80000000 256 MiB
Bank #1: 90000000 0 Bytes
relocation Offset is: 0fef8000
WARNING: Caches not enabled
monitor flash len: 00066970
Now running in RAM - U-Boot at: 8ff00000
Flash: 16 KiB
Flash pflash NOR detected.
MMC:   OMAP SD/MMC: 0
In:    serial
Out:   serial
Err:   serial
fpga_init: CONFIG_FPGA = 0x1
Net:   smc911x-0
Warning: smc911x-0 MAC addresses don&#39;t match:
Address in SROM is         52:54:00:12:34:56
Address in environment is  e4:af:a1:40:01:fe

Reptar #
</pre></div>
</div>
<p>Form the U-Boot prompt we can start the linux kernel using the <cite>boot</cite> command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Reptar # boot
reading uImage

3051480 bytes read
## Booting kernel from Legacy Image at 81600000 ...
   Image Name:   Linux-3.0.12-reptar
   Image Type:   ARM Linux Kernel Image (uncompressed)
   Data Size:    3051416 Bytes = 2.9 MiB
   Load Address: 80008000
   Entry Point:  80008000
   Verifying Checksum ... OK
   Loading Kernel Image ... OK
OK
Using machid 0x2694

Starting kernel ...

Using machid 0x2694
omap2_inth_read: Bad register 0x000020
Linux version 3.0.12-reptar (redsuser@vm-reds64) (gcc version 4.7.3 20130102 (prerelease) (crosstool-NG linaro-1.13.1-4.7-2013.01-20130125 - Linaro GCC 2013.01) ) #1 Thu Feb 18 18:21:09 CET 2016
CPU: ARMv7 Processor [410fc083] revision 3 (ARMv7), cr=10c53c7d
CPU: VIPT nonaliasing data cache, VIPT nonaliasing instruction cache
CPU: running on QEMU emulated environment.
Machine: Reptar Board
Reserving 8388608 bytes SDRAM for VRAM
Memory policy: ECC disabled, Data cache writeback
OMAP3430/3530 ES3.1 (iva sgx neon isp )
SRAM: Mapped pa 0x40200000 to va 0xfe400000 size: 0x10000
Clocking rate (Crystal/Core/MPU): 26.0/13/500 MHz
Reprogramming SDRC clock to 13000000 Hz
dpll3_m2_clk rate change failed: -22
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 62976
Kernel command line: console=ttyO2,115200n8 noinitrd rw consoleblank=0 root=/dev/mmcblk0p2 rootwait
PID hash table entries: 1024 (order: 0, 4096 bytes)
Dentry cache hash table entries: 32768 (order: 5, 131072 bytes)
Inode-cache hash table entries: 16384 (order: 4, 65536 bytes)
Memory: 248MB = 248MB total
Memory: 244860k/244860k available, 17284k reserved, 0K highmem
Virtual kernel memory layout:
    vector  : 0xffff0000 - 0xffff1000   (   4 kB)
    fixmap  : 0xfff00000 - 0xfffe0000   ( 896 kB)
    DMA     : 0xffc00000 - 0xffe00000   (   2 MB)
    vmalloc : 0xd0800000 - 0xf8000000   ( 632 MB)
    lowmem  : 0xc0000000 - 0xd0000000   ( 256 MB)
    modules : 0xbf000000 - 0xc0000000   (  16 MB)
      .text : 0xc0008000 - 0xc05f15e0   (6054 kB)
      .init : 0xc05f2000 - 0xc0620000   ( 184 kB)
      .data : 0xc0620000 - 0xc067fc90   ( 384 kB)
       .bss : 0xc067fcb4 - 0xc06a4a80   ( 148 kB)
NR_IRQS:410
IRQ: Found an INTC at 0xfa200000 (revision 4.0) with 96 interrupts
Total of 96 interrupts on 1 active controller
OMAP clockevent source: GPTIMER1 at 32768 Hz
sched_clock: 32 bits at 32kHz, resolution 30517ns, wraps every 131071999ms
Console: colour dummy device 80x30
Calibrating delay loop... 537.78 BogoMIPS (lpj=2101248)
pid_max: default: 32768 minimum: 301
Mount-cache hash table entries: 512
CPU: Testing write buffer coherency: ok
devtmpfs: initialized
omap_hwmod: _populate_mpu_rt_base found no _mpu_rt_va for l4_core
omap_hwmod: _populate_mpu_rt_base found no _mpu_rt_va for l4_per
omap_hwmod: _populate_mpu_rt_base found no _mpu_rt_va for l4_wkup
omap_hwmod: gpt12_fck: missing clockdomain for gpt12_fck.
omap_hwmod: i2c1: softreset failed (waited 10000 usec)
omap_hwmod: i2c2: softreset failed (waited 10000 usec)
omap_hwmod: i2c3: softreset failed (waited 10000 usec)
omap_hwmod: am35x_otg_hs: cannot be enabled (3)
print_constraints: dummy:
NET: Registered protocol family 16
GPMC revision 5.0
omap_device: omap_gpio.0: new worst case activate latency 0: 274658
OMAP GPIO hardware version 2.5
OMAP GPIO hardware version 2.5
OMAP GPIO hardware version 2.5
OMAP GPIO hardware version 2.5
OMAP GPIO hardware version 2.5
OMAP GPIO hardware version 2.5
omap_mux_init: Add partition: #1: core, flags: 0
omap_device: omap_uart.0: new worst case activate latency 0: 122070
omap_device: omap_uart.0: new worst case deactivate latency 0: 91552
reptar init SPI bus
reptar_init_wifi
Register WIFI regulator
hw-breakpoint: debug architecture 0x0 unsupported.
omap_mcspi_init called
omap_mcspi_init called
omap_mcspi_init called
omap_mcspi_init called
OMAP DMA hardware revision 4.0
bio: create slab &lt;bio-0&gt; at 0
print_constraints: vwl1271: 1800 mV
SCSI subsystem initialized
omap_device: omap2_mcspi.1: new worst case activate latency 0: 61035
omap_device: omap2_mcspi.1: new worst case deactivate latency 0: 122070
bit per word= 8
usbcore: registered new interface driver usbfs
usbcore: registered new interface driver hub
usbcore: registered new device driver usb
omap_device: omap_i2c.1: new worst case activate latency 0: 61035
omap_i2c omap_i2c.1: bus 1 rev3.12 at 2600 kHz
twl4030: PIH (irq 7) chaining IRQs 368..375
twl4030: power (irq 373) chaining IRQs 376..383
twl4030: gpio (irq 368) chaining IRQs 384..401
print_constraints: VUSB1V5: 1500 mV normal standby
print_constraints: VUSB1V8: 1800 mV normal standby
print_constraints: VUSB3V1: 3100 mV normal standby
twl4030_usb twl4030_usb: Initialized TWL4030 USB module
print_constraints: VIO: 1800 mV normal standby
print_constraints: VMMC1: 1850 &lt;--&gt; 3150 mV at 3000 mV normal standby
print_constraints: VDAC: 1800 mV normal standby
print_constraints: VDVI: 1800 mV normal standby
print_constraints: VSIM: 1800 &lt;--&gt; 3000 mV at 1800 mV normal standby
omap_device: omap_i2c.1: new worst case deactivate latency 0: 61035
omap_i2c omap_i2c.2: bus 2 rev3.12 at 400 kHz
omap_i2c omap_i2c.3: bus 3 rev3.12 at 200 kHz
Advanced Linux Sound Architecture Driver Version 1.0.24.
cfg80211: Calling CRDA to update world regulatory domain
Switching to clocksource 32k_counter
Switched to NOHz mode on CPU #0
musb-hdrc: version 6.0, musb-dma, otg (peripheral+host)
omap_device: musb-omap2430.-1: new worst case activate latency 0: 183105
musb-hdrc musb-hdrc: USB OTG mode controller at fa0ab000 using DMA, IRQ 92
omap_device: omap_i2c.1: new worst case activate latency 0: 91552
omap_device: musb-omap2430.-1: new worst case deactivate latency 0: 30517
NET: Registered protocol family 2
IP route cache hash table entries: 2048 (order: 1, 8192 bytes)
TCP established hash table entries: 8192 (order: 4, 65536 bytes)
TCP bind hash table entries: 8192 (order: 3, 32768 bytes)
TCP: Hash tables configured (established 8192 bind 8192)
TCP reno registered
UDP hash table entries: 256 (order: 0, 4096 bytes)
UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
NET: Registered protocol family 1
RPC: Registered named UNIX socket transport module.
RPC: Registered udp transport module.
RPC: Registered tcp transport module.
RPC: Registered tcp NFSv4.1 backchannel transport module.
NetWinder Floating Point Emulator V0.97 (double precision)
VFS: Disk quotas dquot_6.5.2
Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
JFFS2 version 2.2. (NAND) (SUMMARY)  Â© 2001-2006 Red Hat, Inc.
msgmni has been set to 478
io scheduler noop registered
io scheduler deadline registered
io scheduler cfq registered (default)
OMAP DSS rev 2.0
Serial: 8250/16550 driver, 4 ports, IRQ sharing enabled
omap_uart.0: ttyO0 at MMIO 0x4806a000 (irq = 72) is a OMAP UART0
omap_uart.1: ttyO1 at MMIO 0x4806c000 (irq = 73) is a OMAP UART1
omap_uart.2: ttyO2 at MMIO 0x49020000 (irq = 74) is a OMAP UART2
console [ttyO2] enabled
fpgaloader v0.92 ready
brd: module loaded
loop: module loaded
omap2-nand driver initializing
OMAP_NAND       ECC_OPT: 1Reading NAND failed -&gt; probably no NAND (reptar/qemu?)

  No NAND device found.
smsc911x: Driver version 2008-10-21
smsc911x-mdio: probed
smsc911x smsc911x.0: eth0: attached PHY driver [Generic PHY] (mii_bus:phy_addr=0:01, irq=-1)
smsc911x smsc911x.0: eth0: MAC Address: 52:54:00:12:34:56
ehci_hcd: USB 2.0 &#39;Enhanced&#39; Host Controller (EHCI) Driver
ehci-omap ehci-omap.0: OMAP-EHCI Host Controller
ehci-omap ehci-omap.0: new USB bus registered, assigned bus number 1
ehci-omap ehci-omap.0: irq 77, io mem 0x48064800
ehci-omap ehci-omap.0: USB 2.0 started, EHCI 0.00
usb usb1: New USB device found, idVendor=1d6b, idProduct=0002
usb usb1: New USB device strings: Mfr=3, Product=2, SerialNumber=1
usb usb1: Product: OMAP-EHCI Host Controller
usb usb1: Manufacturer: Linux 3.0.12-reptar ehci_hcd
usb usb1: SerialNumber: ehci-omap.0
hub 1-0:1.0: USB hub found
hub 1-0:1.0: 0 ports detected
usbcore: registered new interface driver cdc_acm
cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters
Initializing USB Mass Storage driver...
usbcore: registered new interface driver usb-storage
USB Mass Storage support registered.
usbcore: registered new interface driver usbtest
mousedev: PS/2 mouse device common for all mice
input: gpio-keys as /devices/platform/gpio-keys/input/input0
omap_i2c omap_i2c.3: i2c transfer NACK
edt-ft5x06_i2c 3-0038: i2c_transfer failed, error: -121
edt-ft5x06_i2c 3-0038: Failed to get firmware version, error: -5
edt-ft5x06_i2c: probe of 3-0038 failed with error -5
omap_device: omap_i2c.1: new worst case deactivate latency 0: 732421
twl_rtc twl_rtc: rtc core: registered twl_rtc as rtc0
twl_rtc twl_rtc: Power up reset detected.
twl_rtc twl_rtc: Enabling TWL-RTC.
omap_device: omap_i2c.1: new worst case activate latency 0: 122070
i2c /dev entries driver
Linux video capture interface: v2.00
gspca: v2.13.0 registered
usbcore: registered new interface driver zc3xx
usbcore: registered new interface driver uvcvideo
USB Video Class driver (v1.1.0)
omap_device: omap_wdt.-1: new worst case activate latency 0: 91552
OMAP Watchdog Timer Rev 0x31: initial timeout 60 sec
omap_device: omap_wdt.-1: new worst case deactivate latency 0: 30517
twl4030_wdt twl4030_wdt: Failed to register misc device
twl4030_wdt: probe of twl4030_wdt failed with error -16
usbcore: registered new interface driver usbhid
usbhid: USB HID core driver
mmc0: host does not support reading read-only switch. assuming write-enable.
mmc0: new SD card at address 4567
mmcblk0: mmc0:4567 QEMU! 256 MiB
 mmcblk0: p1 p2
OMAP3 EVM SoC init
omap_device: omap_i2c.1: new worst case activate latency 0: 305175
omap_device: omap_i2c.1: new worst case activate latency 0: 457763
asoc: twl4030-hifi &lt;-&gt; omap-mcbsp-dai.1 mapping ok
ALSA device list:
  #0: omap3evm
TCP cubic registered
Initializing XFRM netlink socket
NET: Registered protocol family 17
NET: Registered protocol family 15
Registering the dns_resolver key type
VFP support v0.3: implementor 41 architecture 3 part 30 variant c rev 2
omap_device: omap_i2c.1: new worst case activate latency 0: 4760742
omap_device: omap_i2c.1: new worst case deactivate latency 0: 2166748
vp_forceupdate_scale_voltage: vdd_mpu TRANXDONE timeout exceeded while tryingto clear the TRANXDONE status
vp_forceupdate_scale_voltage: vdd_core TRANXDONE timeout exceeded while tryingto clear the TRANXDONE status
sr_init: No PMIC hook to init smartreflex
smartreflex smartreflex.0: omap_sr_probe: SmartReflex driver initialized
smartreflex smartreflex.1: omap_sr_probe: SmartReflex driver initialized
clock: disabling unused clocks to save power
omapdss DPI: Could not find exact pixel clock. Requested 33000 kHz, got 33230 kHz
twl_rtc twl_rtc: setting system clock to 2016-03-01 17:35:49 UTC (1456853749)
omap_vout omap_vout: probed for an unknown device
EXT3-fs: barriers not enabled
kjournald starting.  Commit interval 5 seconds
EXT3-fs (mmcblk0p2): warning: mounting fs with errors, running e2fsck is recommended
EXT3-fs (mmcblk0p2): using internal journal
EXT3-fs (mmcblk0p2): mounted filesystem with ordered data mode
VFS: Mounted root (ext3 filesystem) on device 179:2.
devtmpfs: mounted
Freeing init memory: 184K
Starting logging: OK
Starting mdev...
Initializing random number generator... done.
Starting network...
Starting dropbear sshd: OK
Configuring EmbeddedXen Guest devices: /etc/init.d/rcS: /etc/init.d/S60xen_domains.sh: line 38: can&#39;t create /sys/bus/xen-backend/phys_dev_ready: nonexistent directory
/dev/loop0.

*** Welcome on REPTAR (HEIG-VD/REDS): use root/root to log in ***
reptar login:
</pre></div>
</div>
<p>We can login to the linux console using the provieded username &amp; password (&#8220;root&#8221; &amp; &#8220;root&#8221;) and start the executable that is already in the filesystem (placed by previous step):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Welcome</span> <span class="n">on</span> <span class="n">REPTAR</span> <span class="p">(</span><span class="n">HEIG</span><span class="o">-</span><span class="n">VD</span><span class="o">/</span><span class="n">REDS</span><span class="p">):</span> <span class="n">use</span> <span class="n">root</span><span class="o">/</span><span class="n">root</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span> <span class="o">***</span>
<span class="n">reptar</span> <span class="n">login</span><span class="p">:</span> <span class="n">root</span>
<span class="n">Password</span><span class="p">:</span>
<span class="c1"># ls</span>
<span class="n">Settings</span>         <span class="n">fs</span>               <span class="n">helloworld</span>       <span class="n">rootfs_domU</span><span class="o">.</span><span class="n">img</span>
<span class="c1"># ./helloworld</span>
<span class="n">Hello</span> <span class="n">world</span> <span class="n">within</span> <span class="n">Linux</span>
<span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">./</span><span class="n">helloworld</span>
</pre></div>
</div>
<p>We can start as well a Qt demo and see it in the emulator windows. For this, we need to start the application using the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># /usr/share/qt/examples/effects/lighting/lighting -qws &amp;</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>We can then see the following graphics inside the QEMU windows:</p>
<blockquote>
<div><img alt="_images/qt_screenshot.png" src="_images/qt_screenshot.png" />
</div></blockquote>
</div>
<div class="section" id="test-on-real-platform">
<h2>5) Test on real platform<a class="headerlink" href="#test-on-real-platform" title="Permalink to this headline">¶</a></h2>
<p>On this this step we will load the U-Boot helloworld program as we did in step 3, but this time on the REPTAR hardware. For this we need to connect the REPTAR to the host PC using Ethernet and USB. The USB connection is emulating a Serial port on the host PC. The Ethernet Interface on the PC also needs to be configured to have the IP <strong>192.168.1.1</strong> as the U-Boot on the Hardware is configured to download from this address. We need to open the serial port with an appropriate program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ sudo picocom -b 115200 /dev/ttyUSB0
</pre></div>
</div>
<p>We have now access to the REPATR U-Boot console. We need first to setup the networking paramteres using the predefined command:</p>
<blockquote>
<div>Reptar # run setmac setip</div></blockquote>
<p>Once this is done, we can transfer the application using TFTP:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Reptar</span> <span class="c1"># tftp helloworld_u-boot</span>
</pre></div>
</div>
<p>And we can run it:</p>
<blockquote>
<div>Reptar # go 0x81600000</div></blockquote>
</div>
<div class="section" id="reptar-periferal-access">
<h2>6) REPTAR periferal access<a class="headerlink" href="#reptar-periferal-access" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lab2.html" class="btn btn-neutral float-right" title="Periferal Emulations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to SEEE’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Antoine Zen-Ruffinen, Rabia Saeed.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>